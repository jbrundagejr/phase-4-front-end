{"ast":null,"code":"var _jsxFileName = \"/Users/jbrundagejr/Development/code/Mod4/phase-4-final/frontend/vinyl-app/src/components/VinylModal.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { NavLink } from \"react-router-dom\";\nimport { Modal, Image, Input, Rating, Form, Button, Comment, Icon, Card, TextArea } from 'semantic-ui-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction VinylModal({\n  id,\n  tag,\n  loggedInUser\n}) {\n  _s();\n\n  const [vinyl, setVinyl] = useState(null);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [userTitle, setUserTitle] = useState(\"\");\n  const [userContent, setUserContent] = useState(\"\");\n  const [userRating, setUserRating] = useState(\"\");\n  const [open, setOpen] = useState(false);\n  const [reviews, setReviews] = useState([]);\n  useEffect(() => {\n    fetch(`http://localhost:3000/vinyls/${id}`).then(res => res.json()).then(vinylData => {\n      setVinyl(vinylData);\n      setReviews(vinylData.reviews);\n      setIsLoaded(true);\n    });\n  }, [id]);\n  if (!isLoaded) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 24,\n    columnNumber: 25\n  }, this);\n  const {\n    band_name,\n    album_title,\n    image_url,\n    year_released,\n    in_production\n  } = vinyl;\n\n  function handleDelete(id) {\n    fetch(`http://localhost:3000/reviews/${id}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.token}`\n      }\n    }).then(res => res.json()).then(deletedReview => {\n      const updatedReviewArray = reviews.filter(review => review.id !== deletedReview.id);\n      setReviews(updatedReviewArray);\n    });\n  }\n\n  const reviewArray = reviews.map(reviewObj => /*#__PURE__*/_jsxDEV(Comment, {\n    children: /*#__PURE__*/_jsxDEV(Comment.Content, {\n      children: [/*#__PURE__*/_jsxDEV(Comment.Author, {\n        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: reviewObj.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Comment.Author, {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"commentAuthor\",\n          children: [\"By: \", /*#__PURE__*/_jsxDEV(NavLink, {\n            to: `/profiles/${reviewObj.user.id}`,\n            children: reviewObj.user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 51\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Comment.Text, {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: reviewObj.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Comment.Text, {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Rating: \", reviewObj.rating]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this), loggedInAndMatchStatus(reviewObj) ? /*#__PURE__*/_jsxDEV(Icon, {\n        name: \"trash alternate\",\n        onClick: () => handleDelete(reviewObj.id)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 46\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this)\n  }, reviewObj.id, false, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 5\n  }, this));\n\n  function rateAlbum(e, {\n    rating,\n    maxRating\n  }) {\n    setUserRating({\n      rating,\n      maxRating\n    });\n  }\n\n  function loggedInAndMatchStatus(reviewObj) {\n    if (loggedInUser) {\n      if (loggedInUser.user === reviewObj.user_id) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }\n\n  function handleReviewSubmit(e) {\n    e.preventDefault();\n    const reviewData = {\n      vinyl_id: id,\n      title: userTitle,\n      content: userContent,\n      rating: userRating.rating\n    }; // console.log(reviewData.rating)\n\n    fetch(\"http://localhost:3000/reviews\", {\n      method: \"POST\",\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.token}`,\n        \"Content-type\": \"application/json\"\n      },\n      body: JSON.stringify(reviewData)\n    }).then(res => res.json()).then(newReview => {\n      setReviews([...reviews, newReview]);\n      setUserTitle(\"\");\n      setUserContent(\"\");\n    });\n  }\n\n  function checkTag(tag) {\n    if (tag === \"review\") {\n      return /*#__PURE__*/_jsxDEV(Image, {\n        size: \"small\",\n        src: image_url,\n        alt: album_title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 14\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(Card, {\n        children: /*#__PURE__*/_jsxDEV(Image, {\n          src: image_url,\n          alt: band_name,\n          wrapped: true,\n          ui: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 14\n      }, this);\n    }\n  }\n\n  function averageRating(reviewArr) {\n    if (reviewArr.length !== 0) {\n      const ratings = reviewArr.map(review => {\n        return review.rating;\n      });\n      return ratings.reduce((a, b) => a + b) / ratings.length;\n    } else {\n      return 0;\n    }\n  }\n\n  function starRatingDecimal(rating) {\n    if (rating <= 1) {\n      return \"⭐\";\n    } else if (rating > 1 && rating <= 2) {\n      return \"⭐⭐\";\n    } else if (rating > 2 && rating <= 3) {\n      return \"⭐⭐⭐\";\n    } else if (rating > 3 && rating <= 4) {\n      return \"⭐⭐⭐⭐\";\n    } else {\n      return \"⭐⭐⭐⭐⭐\";\n    }\n  }\n\n  function isUserLoggedIn() {\n    if (loggedInUser) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"rate-title\",\n          children: \"Review this album\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form, {\n          onSubmit: handleReviewSubmit,\n          reply: true,\n          children: [/*#__PURE__*/_jsxDEV(Input, {\n            value: userTitle,\n            placeholder: \"Your Title\",\n            onChange: e => setUserTitle(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextArea, {\n            value: userContent,\n            placeholder: \"Your Review\",\n            onChange: e => setUserContent(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Rating, {\n            onRate: rateAlbum,\n            value: userRating,\n            maxRating: 5,\n            clearable: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            content: \"Add Review\",\n            labelPosition: \"left\",\n            icon: \"edit\",\n            primary: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }, this);\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"vinyl-modal\",\n    children: /*#__PURE__*/_jsxDEV(Modal, {\n      onClose: () => setOpen(false),\n      onOpen: () => setOpen(true),\n      open: open,\n      trigger: checkTag(tag),\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: album_title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Content, {\n        image: true,\n        children: [/*#__PURE__*/_jsxDEV(Image, {\n          size: \"medium\",\n          src: image_url,\n          wrapped: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Modal.Description, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: band_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Year Released:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 16\n            }, this), \" \", year_released]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Still in Production?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 16\n            }, this), \" \", in_production ? \"Yes\" : \"No\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Average User Rating:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 16\n            }, this), \" \", starRatingDecimal(averageRating(reviews)), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Comment.Group, {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Reviews\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 13\n            }, this), reviewArray, loggedInUser ? isUserLoggedIn() : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 151,\n    columnNumber: 5\n  }, this);\n}\n\n_s(VinylModal, \"NkH13ogcIYKZhe5xkvzM4P5MSG4=\");\n\n_c = VinylModal;\nexport default VinylModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"VinylModal\");","map":{"version":3,"sources":["/Users/jbrundagejr/Development/code/Mod4/phase-4-final/frontend/vinyl-app/src/components/VinylModal.js"],"names":["useState","useEffect","NavLink","Modal","Image","Input","Rating","Form","Button","Comment","Icon","Card","TextArea","VinylModal","id","tag","loggedInUser","vinyl","setVinyl","isLoaded","setIsLoaded","userTitle","setUserTitle","userContent","setUserContent","userRating","setUserRating","open","setOpen","reviews","setReviews","fetch","then","res","json","vinylData","band_name","album_title","image_url","year_released","in_production","handleDelete","method","headers","localStorage","token","deletedReview","updatedReviewArray","filter","review","reviewArray","map","reviewObj","title","user","name","content","rating","loggedInAndMatchStatus","rateAlbum","e","maxRating","user_id","handleReviewSubmit","preventDefault","reviewData","vinyl_id","body","JSON","stringify","newReview","checkTag","averageRating","reviewArr","length","ratings","reduce","a","b","starRatingDecimal","isUserLoggedIn","target","value"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react'\nimport {NavLink} from \"react-router-dom\"\nimport {Modal, Image, Input, Rating, Form, Button, Comment, Icon, Card, TextArea} from 'semantic-ui-react'\n\nfunction VinylModal({id, tag, loggedInUser}){\n  const [vinyl, setVinyl] = useState(null)\n  const [isLoaded, setIsLoaded] = useState(false)\n  const [userTitle, setUserTitle] = useState(\"\")\n  const [userContent, setUserContent] = useState(\"\")\n  const [userRating, setUserRating] = useState(\"\")\n  const [open, setOpen] = useState(false)\n  const [reviews, setReviews] = useState([])\n\n  useEffect(() => {\n    fetch(`http://localhost:3000/vinyls/${id}`)\n      .then(res => res.json())\n      .then(vinylData => {\n        setVinyl(vinylData)\n        setReviews(vinylData.reviews)\n        setIsLoaded(true)\n      })\n  }, [id])\n\n  if (!isLoaded) return <p>Loading...</p>\n\n  const {band_name, album_title, image_url, year_released, in_production} = vinyl\n  \n  function handleDelete(id){\n    fetch(`http://localhost:3000/reviews/${id}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.token}`,\n      }\n    })\n      .then(res => res.json())\n      .then((deletedReview) => {\n        const updatedReviewArray = reviews.filter(review =>\n          review.id !== deletedReview.id\n        )\n        setReviews(updatedReviewArray)\n      })\n  }\n\n  const reviewArray = reviews.map(reviewObj => \n    <Comment key={reviewObj.id}>\n      <Comment.Content>\n        <Comment.Author><h4>{reviewObj.title}</h4></Comment.Author>\n        {/* <Comment.Author>By: {reviewObj.user.name}</Comment.Author> */}\n        <Comment.Author><p id=\"commentAuthor\">By: <NavLink to={`/profiles/${reviewObj.user.id}`}>{reviewObj.user.name}</NavLink></p></Comment.Author>\n        <Comment.Text><p>{reviewObj.content}</p></Comment.Text>\n        <Comment.Text><p>Rating: {reviewObj.rating}</p></Comment.Text>\n        {loggedInAndMatchStatus(reviewObj) ? <Icon name=\"trash alternate\" onClick={() => handleDelete(reviewObj.id)}></Icon> : null}\n        {/* {loggedInUser.user === reviewObj.user_id ? <Icon name=\"trash alternate\" onClick={() => handleDelete(reviewObj.id)}></Icon> : null} */}\n      </Comment.Content>\n    </Comment>\n  )\n\n  function rateAlbum(e, {rating, maxRating}){\n    setUserRating({rating, maxRating})\n  }\n\n  function loggedInAndMatchStatus(reviewObj) {\n      if (loggedInUser) {\n        if (loggedInUser.user === reviewObj.user_id) {\n          return true\n        } else {\n          return false\n        }\n      } else {\n        return false\n      }\n    }\n\n  function handleReviewSubmit(e){\n    e.preventDefault()\n    const reviewData = {\n      vinyl_id: id,\n      title: userTitle,\n      content: userContent,\n      rating: userRating.rating\n    }\n\n    // console.log(reviewData.rating)\n    fetch(\"http://localhost:3000/reviews\", {\n      method: \"POST\",\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.token}`,\n        \"Content-type\": \"application/json\"\n      },\n      body: JSON.stringify(reviewData)\n    })\n      .then(res => res.json())\n      .then(newReview => {\n        setReviews([...reviews, newReview])\n        setUserTitle(\"\")\n        setUserContent(\"\")\n\n      })\n  }\n\n  function checkTag(tag) {\n    if (tag === \"review\") {\n      return <Image size=\"small\" src={image_url} alt={album_title}/>\n    } else {\n      return <Card><Image src={image_url} alt={band_name} wrapped ui={false} /></Card>\n    }\n  }\n\n  function averageRating(reviewArr) {\n    if (reviewArr.length !== 0) {\n      const ratings = reviewArr.map((review) => {\n        return review.rating\n      })\n      return ratings.reduce((a, b) => a + b) / ratings.length\n    } else {\n      return 0\n    }\n  }\n\n  function starRatingDecimal(rating) {\n    if (rating <= 1) {\n      return \"⭐\"\n  } else if (rating > 1 && rating <= 2) {\n      return \"⭐⭐\"\n  } else if (rating > 2 && rating <= 3) {\n      return \"⭐⭐⭐\"\n  } else if (rating > 3 && rating <= 4) {\n      return \"⭐⭐⭐⭐\"\n  } else {\n      return \"⭐⭐⭐⭐⭐\"\n  }\n  }\n\n  function isUserLoggedIn(){\n    if (loggedInUser) {\n      return (\n          <div>\n            <h4 className=\"rate-title\">Review this album</h4>\n            <Form onSubmit={handleReviewSubmit} reply>\n            <Input value={userTitle} placeholder=\"Your Title\" onChange={e => setUserTitle(e.target.value)}/>\n            <TextArea value={userContent} placeholder=\"Your Review\" onChange={e => setUserContent(e.target.value)}/>\n            <Rating onRate={rateAlbum} value={userRating} maxRating={5} clearable/>\n            <br/>\n            <Button content='Add Review' labelPosition='left' icon='edit' primary />\n            </Form>\n          </div>)\n    }\n  }\n\n  return (\n    <div className=\"vinyl-modal\">\n      <Modal\n        onClose={() => setOpen(false)}\n        onOpen={() => setOpen(true)}\n        open={open}\n        trigger={checkTag(tag)}>\n        <Modal.Header><h3>{album_title}</h3></Modal.Header>\n        <Modal.Content image>\n          <Image size='medium' src={image_url} wrapped />\n          <Modal.Description>\n            <h3>{band_name}</h3>\n            <p><span>Year Released:</span> {year_released}</p>\n            <p><span>Still in Production?</span> {in_production ? \"Yes\" : \"No\"}</p>\n            <p><span>Average User Rating:</span> {starRatingDecimal(averageRating(reviews))} </p>\n          <Comment.Group>\n            <h3>Reviews</h3>\n            {reviewArray}\n            {loggedInUser ? isUserLoggedIn() : null }\n          </Comment.Group>\n        </Modal.Description>\n      </Modal.Content>\n    </Modal>\n    </div>\n  )\n}\n\nexport default VinylModal"]},"metadata":{},"sourceType":"module"}